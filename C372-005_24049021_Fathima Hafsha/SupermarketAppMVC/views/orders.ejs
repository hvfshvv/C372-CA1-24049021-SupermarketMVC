<%- include("partials/header"); %>

<h2 class="fw-bold mb-4">My Orders</h2>

<% if (!orders || orders.length === 0) { %>
    <div class="alert alert-info">
        You have not placed any orders yet.
    </div>
<% } else { %>
    <table class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Total Amount ($)</th>
                <th>Invoice</th>
            </tr>
        </thead>
        <tbody>
            <% orders.forEach(o => { 
                const dateStr = (o.order_date instanceof Date)
                    ? o.order_date.toLocaleString()
                    : String(o.order_date);

                const totalNum = Number(o.total_amount) || 0;
            %>
                <tr>
                    <td>#<%= o.id %></td>
                    <td><%= dateStr %></td>
                    <td><%= totalNum.toFixed(2) %></td>
                    <td>
                        <a href="/invoice/<%= o.id %>" class="btn btn-sm btn-outline-primary">
                            Download Invoice
                        </a>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
<% } %>

<a href="/shop" class="btn btn-secondary mt-3">Back to Shop</a>

<%- include("partials/footer"); %>
