<%- include("partials/header"); %>

<div class="container mt-5">
    <div class="d-flex justify-content-center">
        <div class="card p-4 shadow-lg" style="max-width: 850px; width: 100%; border-radius: 20px;">
            <div class="row g-4">

                <!-- PRODUCT IMAGE -->
                <div class="col-md-5 d-flex justify-content-center align-items-center">
                    <img src="/images/<%= product.image %>" class="img-fluid rounded"
                         style="max-height: 350px; object-fit: contain;">
                </div>

                <!-- PRODUCT DETAILS -->
                <div class="col-md-7">

                    <h2 class="fw-bold mb-3" style="color: #1f2a5c;">
                        <%= product.productName %>
                    </h2>

                    <hr>

                    <!-- FLASH MESSAGE BOXES -->
                    <% if (messages && messages.error && messages.error.length > 0) { %>
                        <div class="alert alert-danger d-flex align-items-center" 
                             style="border-left: 5px solid #b30000;">
                            <i class="bi bi-x-circle-fill me-2"></i>
                            <div><%= messages.error[0] %></div>
                        </div>
                    <% } %>

                    <p class="fs-5 mb-1">
                        <strong>Price:</strong>
                        <span class="text-success fw-bold">$<%= product.price.toFixed(2) %></span>
                    </p>

                    <p class="mb-3">
                        <strong>Stock:</strong>
                        <% if (product.quantity===0) { %>
                            <span class="badge bg-danger ms-2">Out of Stock</span>
                        <% } else if (product.quantity <=5) { %>
                            <span class="badge bg-warning text-dark ms-2">
                                Low Stock: <%= product.quantity %>
                            </span>
                        <% } else { %>
                            <span class="badge bg-success ms-2">
                                In Stock: <%= product.quantity %>
                            </span>
                        <% } %>
                    </p>

                    <!-- ADD TO CART -->
                    <% if (product.quantity > 0) { %>
                        <form action="/add-to-cart/<%= product.id %>" method="POST" class="d-flex mb-3">
                            <input type="number" 
                                   name="quantity" 
                                   min="1" 
                                   max="<%= product.quantity %>"
                                   value="1"
                                   class="form-control me-2"
                                   style="max-width: 100px;">
                            <button class="btn btn-success fw-bold px-4">
                                <i class="bi bi-cart-plus me-1"></i> Add to Cart
                            </button>
                        </form>
                    <% } else { %>
                        <button class="btn btn-secondary w-100 fw-bold mb-3" disabled>
                            Out of Stock
                        </button>
                    <% } %>

                    <!-- BACK BUTTON -->
                    <a href="/shop" class="btn btn-outline-primary w-100 fw-bold" style="border-width: 2px;">
                        Back to Shop
                    </a>

                </div>
            </div>
        </div>
    </div>
</div>

<%- include("partials/footer"); %>
