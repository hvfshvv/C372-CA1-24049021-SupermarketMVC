<%- include("partials/header"); %>

<h1 class="mb-4">Inventory Management</h1>

<a href="/addproduct" class="btn btn-success mb-3">+ Add Product</a>

<table class="table table-bordered table-striped">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Image</th>
            <th>Name</th>
            <th>Category</th>
            <th>Qty</th>
            <th>Price ($)</th>
            <th>Actions</th>
        </tr>
    </thead>
    
    <tbody>
        <% products.forEach(p => { %>
        <tr class="<%= p.quantity < 10 ? 'table-danger' : '' %>">

            <!-- ID -->
            <td><%= p.id %></td>

            <!-- IMAGE -->
            <td>
                <img src="/images/<%= p.image %>" 
                     style="height:60px; width:60px; object-fit:cover;">
            </td>

            <!-- NAME -->
            <td><%= p.productName %></td>

            <!-- CATEGORY BADGE -->
            <td>
                <span class="badge 
                    <% if (p.category === 'Fruits') { %> bg-success 
                    <% } else if (p.category === 'Vegetables') { %> bg-success 
                    <% } else if (p.category === 'Dairy') { %> bg-primary 
                    <% } else if (p.category === 'Bakery') { %> bg-warning text-dark
                    <% } else if (p.category === 'Beverages') { %> bg-info text-dark
                    <% } else if (p.category === 'Snacks') { %> bg-danger 
                    <% } else { %> bg-secondary <% } %>
                ">
                    <%= p.category %>
                </span>
            </td>

            <!-- QUANTITY WITH LOW STOCK ALERT -->
            <td>
                <% if (p.quantity < 10) { %>
                    <span class="text-danger fw-bold">Low Stock! (<%= p.quantity %> left)</span>
                <% } else { %>
                    <%= p.quantity %>
                <% } %>
            </td>

            <!-- PRICE -->
            <td>$<%= p.price.toFixed(2) %></td>

            <!-- ACTIONS -->
            <td>
                <a href="/updateproduct/<%= p.id %>" class="btn btn-warning btn-sm mb-1">Edit</a>

                <form action="/deleteproduct/<%= p.id %>" method="POST" style="display:inline;">
                    <button class="btn btn-danger btn-sm">Delete</button>
                </form>
            </td>

        </tr>
        <% }) %>
    </tbody>
</table>

<%- include("partials/footer"); %>
